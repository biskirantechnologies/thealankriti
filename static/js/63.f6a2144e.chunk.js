"use strict";(self.webpackChunkTheAlankriti_jewells_frontend=self.webpackChunkTheAlankriti_jewells_frontend||[]).push([[63],{63:(e,s,a)=>{a.r(s),a.d(s,{default:()=>b});var t=a(2555),r=a(5043),i=a(3216),l=a(12),n=a(6938),c=a(4538),d=a(7925),m=a(3641),o=a(7904),x=a(8153),p=a(5889),u=a(2224),h=a(5016),y=a(6305),g=a(1614),j=a(2339),f=a(579);const b=()=>{const e=(0,i.Zp)(),{cartItems:s,clearCart:a,getTotalPrice:b}=(0,u._$)(),{user:N}=(0,h.As)(),[v,w]=(0,r.useState)(1),[k,C]=(0,r.useState)("upi"),[A,S]=(0,r.useState)(null),[P,I]=(0,r.useState)(null),[T,O]=(0,r.useState)("pending"),[D,L]=(0,r.useState)(!1),[F,q]=(0,r.useState)({firstName:(null===N||void 0===N?void 0:N.firstName)||"",lastName:(null===N||void 0===N?void 0:N.lastName)||"",email:(null===N||void 0===N?void 0:N.email)||"",phone:(null===N||void 0===N?void 0:N.phone)||"",address:"",city:"",state:"",pincode:"",country:"India"}),[E,U]=(0,r.useState)(""),[_,z]=(0,r.useState)(null),Y=b(),J=Y>25e3?0:500,M=_?Y*_.percentage/100:0,G=.03*(Y-M),Q=Y+J-M+G,R=[{id:1,name:"Shipping",status:v>=1?"complete":"upcoming"},{id:2,name:"Payment",status:v>=2?"complete":"upcoming"},{id:3,name:"Confirmation",status:v>=3?"complete":"upcoming"}];(0,r.useEffect)(()=>{N||(j.Ay.error("Please login to continue"),e("/login",{state:{from:{pathname:"/checkout"}}})),0===s.length&&(j.Ay.error("Your cart is empty"),e("/products"))},[N,s,e]);const V=e=>{q((0,t.A)((0,t.A)({},F),{},{[e.target.name]:e.target.value}))},W=()=>{const e={upiId:"TheAlankriti.jewells@paytm",payeeName:"The Alankriti",amount:Q,transactionId:"UJ".concat(Date.now()),note:"Order payment for The Alankriti"},s="upi://pay?pa=".concat(e.upiId,"&pn=").concat(e.payeeName,"&am=").concat(e.amount,"&tr=").concat(e.transactionId,"&tn=").concat(e.note);return I((0,t.A)((0,t.A)({},e),{},{qrString:s})),e},B=async()=>{L(!0),O("processing");try{const e={id:"UJ".concat(Date.now()),items:cart,shippingInfo:F,subtotal:Y,shippingCost:J,discount:M,tax:G,total:Q,paymentMethod:k,status:"pending",createdAt:(new Date).toISOString()};if("upi"===k||"qr"===k){const s=W();S((0,t.A)((0,t.A)({},e),{},{paymentData:s})),w(3),setTimeout(()=>{O("success"),H(e)},3e4)}else setTimeout(()=>{O("success"),S(e),w(3),H(e)},2e3)}catch(e){O("failed"),j.Ay.error("Payment failed. Please try again.")}finally{L(!1)}},H=async t=>{try{const t={items:s.map(e=>({product:e.id,quantity:e.quantity,price:e.price})),shippingAddress:{firstName:F.firstName,lastName:F.lastName,email:F.email,phone:F.phone,street:F.address,city:F.city,state:F.state,zipCode:F.pincode,country:F.country},paymentMethod:k,totalAmount:Q,subtotal:Y,shippingCost:J,tax:G,discount:M,couponCode:(null===_||void 0===_?void 0:_.code)||null},r=await y.gH.createOrder(t);console.log("Order created:",r.data),a(),j.Ay.success("Order placed successfully!"),setTimeout(()=>{e("/order-success/".concat(r.data.order._id))},3e3)}catch(r){console.error("Error processing order:",r),j.Ay.error("Order processing failed. Please try again."),O("failed")}};return 0===s.length?null:(0,f.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,f.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,f.jsx)("div",{className:"mb-8",children:(0,f.jsx)("nav",{"aria-label":"Progress",children:(0,f.jsx)("ol",{className:"flex items-center justify-center",children:R.map((e,s)=>(0,f.jsxs)("li",{className:"".concat(s!==R.length-1?"pr-8 sm:pr-20":""," relative"),children:[(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full ".concat("complete"===e.status||v===e.id?"bg-primary-600":"bg-gray-300"),children:"complete"===e.status?(0,f.jsx)(c.A,{className:"w-6 h-6 text-white"}):(0,f.jsx)("span",{className:"text-white font-medium",children:e.id})}),(0,f.jsx)("span",{className:"ml-4 text-sm font-medium ".concat("complete"===e.status||v===e.id?"text-gray-900":"text-gray-500"),children:e.name})]}),s!==R.length-1&&(0,f.jsx)("div",{className:"absolute top-5 left-10 w-8 sm:w-20 h-0.5 bg-gray-300"})]},e.name))})})}),(0,f.jsxs)("div",{className:"lg:grid lg:grid-cols-12 lg:gap-x-12",children:[(0,f.jsxs)("div",{className:"lg:col-span-8",children:[(0,f.jsxs)(n.N,{mode:"wait",children:[1===v&&(0,f.jsxs)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white shadow rounded-lg p-6",children:[(0,f.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Shipping Information"}),(0,f.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"First name"}),(0,f.jsx)("input",{type:"text",name:"firstName",value:F.firstName,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Last name"}),(0,f.jsx)("input",{type:"text",name:"lastName",value:F.lastName,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),(0,f.jsxs)("div",{className:"sm:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,f.jsx)("input",{type:"email",name:"email",value:F.email,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),(0,f.jsxs)("div",{className:"sm:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone number"}),(0,f.jsx)("input",{type:"tel",name:"phone",value:F.phone,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),(0,f.jsxs)("div",{className:"sm:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),(0,f.jsx)("input",{type:"text",name:"address",value:F.address,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),(0,f.jsx)("input",{type:"text",name:"city",value:F.city,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),(0,f.jsx)("input",{type:"text",name:"state",value:F.state,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"PIN code"}),(0,f.jsx)("input",{type:"text",name:"pincode",value:F.pincode,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),(0,f.jsx)("select",{name:"country",value:F.country,onChange:V,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500",children:(0,f.jsx)("option",{value:"India",children:"India"})})]})]})]},"shipping"),2===v&&(0,f.jsxs)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white shadow rounded-lg p-6",children:[(0,f.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Payment Method"}),(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("input",{id:"upi",name:"payment-method",type:"radio",value:"upi",checked:"upi"===k,onChange:e=>C(e.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),(0,f.jsxs)("label",{htmlFor:"upi",className:"ml-3 flex items-center",children:[(0,f.jsx)(o.A,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,f.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"UPI / QR Payment"})]})]}),(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("input",{id:"card",name:"payment-method",type:"radio",value:"card",checked:"card"===k,onChange:e=>C(e.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),(0,f.jsxs)("label",{htmlFor:"card",className:"ml-3 flex items-center",children:[(0,f.jsx)(d.A,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,f.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Credit / Debit Card"})]})]})]}),"card"===k&&(0,f.jsx)("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,f.jsx)("p",{className:"text-sm text-yellow-800",children:"Card payment integration coming soon. Please use UPI payment for now."})}),(0,f.jsxs)("div",{className:"mt-6 flex items-center text-sm text-gray-500",children:[(0,f.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Your payment information is secure and encrypted"]})]},"payment"),3===v&&(0,f.jsxs)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white shadow rounded-lg p-6",children:["upi"===k&&"processing"===T&&P&&(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Complete Your Payment"}),(0,f.jsxs)("div",{className:"max-w-sm mx-auto",children:[(0,f.jsx)("div",{className:"bg-white p-4 rounded-lg border-2 border-gray-200 mb-4",children:(0,f.jsx)(g.Ay,{value:P.qrString,size:200,className:"mx-auto"})}),(0,f.jsxs)("div",{className:"text-sm text-gray-600 space-y-2",children:[(0,f.jsxs)("p",{children:[(0,f.jsx)("strong",{children:"Amount:"})," \u20b9",Q.toLocaleString()]}),(0,f.jsxs)("p",{children:[(0,f.jsx)("strong",{children:"Transaction ID:"})," ",P.transactionId]}),(0,f.jsx)("p",{className:"text-xs mt-4",children:"Scan with any UPI app to pay"})]}),(0,f.jsxs)("div",{className:"mt-6 flex items-center justify-center text-blue-600",children:[(0,f.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Waiting for payment confirmation..."]}),(0,f.jsx)("button",{onClick:()=>{O("pending"),W()},className:"mt-4 text-sm text-primary-600 hover:text-primary-500",children:"Generate new QR code"})]})]}),"success"===T&&(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)(c.A,{className:"mx-auto h-16 w-16 text-green-500 mb-4"}),(0,f.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Successful!"}),(0,f.jsx)("p",{className:"text-gray-600 mb-6",children:"Your order has been placed successfully."}),A&&(0,f.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-left",children:[(0,f.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"Order Details:"}),(0,f.jsxs)("p",{className:"text-sm text-gray-600",children:["Order ID: ",A.id]}),(0,f.jsxs)("p",{className:"text-sm text-gray-600",children:["Total: \u20b9",A.total.toLocaleString()]}),(0,f.jsxs)("p",{className:"text-sm text-gray-600",children:["Items: ",A.items.length]})]}),(0,f.jsx)("p",{className:"text-sm text-gray-500 mt-4",children:"You will receive an email confirmation shortly."})]}),"failed"===T&&(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("div",{className:"mx-auto h-16 w-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,f.jsx)("span",{className:"text-red-600 text-2xl",children:"\u2715"})}),(0,f.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Failed"}),(0,f.jsx)("p",{className:"text-gray-600 mb-6",children:"There was an issue processing your payment."}),(0,f.jsx)("button",{onClick:()=>w(2),className:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700",children:"Try Again"})]})]},"confirmation")]}),v<3&&(0,f.jsxs)("div",{className:"mt-6 flex justify-between",children:[v>1&&(0,f.jsx)("button",{onClick:()=>w(v-1),className:"bg-gray-200 text-gray-700 px-6 py-2 rounded-md hover:bg-gray-300",children:"Back"}),(0,f.jsx)("button",{onClick:()=>{1===v?(()=>{const e=["firstName","lastName","email","phone","address","city","state","pincode"];for(let s of e)if(!F[s])return j.Ay.error("Please fill in ".concat(s)),!1;return!0})()&&w(2):2===v&&B()},disabled:D,className:"ml-auto bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 disabled:opacity-50",children:D?"Processing...":1===v?"Continue to Payment":"Place Order"})]})]}),(0,f.jsx)("div",{className:"lg:col-span-4 mt-8 lg:mt-0",children:(0,f.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 sticky top-4",children:[(0,f.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),(0,f.jsx)("div",{className:"space-y-4 mb-6",children:cart.map(e=>(0,f.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,f.jsx)("img",{src:e.image,alt:e.name,className:"h-16 w-16 rounded-md object-cover"}),(0,f.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,f.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,f.jsxs)("p",{className:"text-sm text-gray-500",children:["Size: ",e.size]}),(0,f.jsxs)("p",{className:"text-sm text-gray-500",children:["Qty: ",e.quantity]})]}),(0,f.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["\u20b9",(e.price*e.quantity).toLocaleString()]})]},"".concat(e.id,"-").concat(e.size)))}),(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsxs)("div",{className:"flex space-x-2",children:[(0,f.jsx)("input",{type:"text",placeholder:"Coupon code",value:E,onChange:e=>U(e.target.value),className:"flex-1 border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"}),(0,f.jsx)("button",{onClick:()=>{const e={WELCOME10:{percentage:10,description:"10% off on first order"},FESTIVAL20:{percentage:20,description:"20% festival discount"},SAVE5:{percentage:5,description:"5% off on all orders"}};e[E]?(z(e[E]),j.Ay.success("Coupon applied! ".concat(e[E].description))):j.Ay.error("Invalid coupon code")},className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700",children:"Apply"})]}),_&&(0,f.jsxs)("p",{className:"text-sm text-green-600 mt-2",children:["\u2713 ",_.description]})]}),(0,f.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{children:"Subtotal"}),(0,f.jsxs)("span",{children:["\u20b9",Y.toLocaleString()]})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{children:"Shipping"}),(0,f.jsx)("span",{children:0===J?"Free":"\u20b9".concat(J)})]}),M>0&&(0,f.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,f.jsx)("span",{children:"Discount"}),(0,f.jsxs)("span",{children:["-\u20b9",M.toLocaleString()]})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{children:"Tax (GST)"}),(0,f.jsxs)("span",{children:["\u20b9",G.toFixed(2)]})]}),(0,f.jsxs)("div",{className:"border-t border-gray-200 pt-2 flex justify-between font-semibold",children:[(0,f.jsx)("span",{children:"Total"}),(0,f.jsxs)("span",{children:["\u20b9",Q.toLocaleString()]})]})]}),(0,f.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,f.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,f.jsxs)("div",{className:"flex flex-col items-center",children:[(0,f.jsx)(x.A,{className:"h-6 w-6 text-green-500 mb-1"}),(0,f.jsx)("span",{className:"text-xs text-gray-600",children:"Secure"})]}),(0,f.jsxs)("div",{className:"flex flex-col items-center",children:[(0,f.jsx)(p.A,{className:"h-6 w-6 text-blue-500 mb-1"}),(0,f.jsx)("span",{className:"text-xs text-gray-600",children:"Fast Delivery"})]}),(0,f.jsxs)("div",{className:"flex flex-col items-center",children:[(0,f.jsx)(c.A,{className:"h-6 w-6 text-purple-500 mb-1"}),(0,f.jsx)("span",{className:"text-xs text-gray-600",children:"Guaranteed"})]})]})})]})})]})]})})}}}]);
//# sourceMappingURL=63.f6a2144e.chunk.js.map